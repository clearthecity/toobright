{"version":3,"sources":["webpack:///./src/components/SafeToDrive.vue?b813","webpack:///src/components/SafeToDrive.vue","webpack:///./src/components/SafeToDrive.vue?ea0f","webpack:///./src/components/SafeToDrive.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","id","_v","_s","waitUntil","directionWarning","staticClass","to","staticRenderFns","HIGH_DANGER","LOW_DANGER","SafeToDrivevue_type_script_lang_js_","name","props","sunAltitude","Number","sunAzimuth","userLatitude","userLongitude","[object Object]","isSafe","mounted","startTimeCalculations","computed","methods","moment","$moment","now","SunCalc","$suncalc","addTime","sunTimesToday","getTimes","vm","tomorrow","add","sunTimesTomorrow","getTimeToDanger","then","timeUntil","error","console","log","writeWaitMessage","getTimeToSafety","Promise","resolve","reject","Error","morningDangerEnd","eveningDangerEnd","isBefore","hour","morningDangerBegin","eveningDangerBegin","difference","diff","components_SafeToDrivevue_type_script_lang_js_","component","Object","componentNormalizer","__webpack_exports__"],"mappings":"yHAAA,IAAAA,EAAA,WAA0B,IAAAC,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,MAAA,CAAOC,GAAA,kBAAsB,CAAAP,EAAA,OAAAI,EAAA,OAAAA,EAAA,KAAAJ,EAAAQ,GAAA,6BAAAJ,EAAA,QAAAJ,EAAAQ,GAAAR,EAAAS,GAAAT,EAAAU,kBAAAN,EAAA,OAAAA,EAAA,KAAAJ,EAAAQ,GAAAR,EAAAS,GAAAT,EAAAW,qBAAAP,EAAA,KAAAJ,EAAAQ,GAAA,uBAAAR,EAAAS,GAAAT,EAAAU,gBAAAN,EAAA,MAAAA,EAAA,MAAAA,EAAA,KAAAA,EAAA,eAA0RQ,YAAA,OAAAN,MAAA,CAA0BO,GAAA,WAAe,CAAAb,EAAAQ,GAAA,kBAC1cM,EAAA,GCqBA,MAAAC,EAAA,GACAC,EAAA,EAEA,IAAAC,EAAA,CACAC,KAAA,cACAC,MAAA,CACAC,YAAAC,OACAC,WAAAD,OACAE,aAAAF,OACAG,cAAAH,QAEAI,OACA,OACAC,QAAA,EACAhB,UAAA,KAGAiB,QAAA,WACA1B,KAAAmB,aAAAJ,GAAAf,KAAAmB,aAAAL,IACAd,KAAAyB,QAAA,GAEAzB,KAAA2B,yBAEAC,SAAA,CACAlB,iBAAA,WACA,OAAAV,KAAAqB,YAAA,IAAArB,KAAAqB,YAAA,IACA,0BAEA,4BAGAQ,QAAA,CACAF,sBAAA,WACA,IAAAG,EAAA9B,KAAA+B,QACA,IAAAC,EAAAF,IAEA,IAAAG,EAAAjC,KAAAkC,SACAD,EAAAE,QAAArB,EAAA,yCACAmB,EAAAE,QAAApB,EAAA,yCACA,IAAAqB,EAAAH,EAAAI,SAAAL,EAAAhC,KAAAsB,aAAAtB,KAAAuB,eAEAe,EAAAtC,KAEA,GAAAA,KAAAyB,OAAA,CACA,IAAAc,EAAAT,IAAAU,IAAA,OACAC,EAAAR,EAAAI,SAAAE,EAAAvC,KAAAsB,aAAAtB,KAAAuB,eACAvB,KAAA0C,gBAAAN,EAAAK,GACAE,KAAA,SAAAC,GACA,OAAAA,GACA,SAAAC,GACAC,QAAAC,IAAAF,KAEAF,KAAA,SAAAC,GACAN,EAAAU,iBAAAJ,UAIA5C,KAAAiD,gBAAAb,GACAO,KAAA,SAAAC,GACA,OAAAA,GACA,SAAAC,GACAC,QAAAC,IAAAF,KAEAF,KAAA,SAAAC,GACAN,EAAAU,iBAAAJ,MAKAK,gBAAA,SAAAb,GACA,WAAAc,QAAA,CAAAC,EAAAC,KACA,IAAAtB,EAAA9B,KAAA+B,QACAD,GACAsB,EAAAC,MAAA,0CAGArD,KAAAmB,aAAAJ,EACAoC,EAAAf,EAAAkB,kBAGAH,EAAAf,EAAAmB,qBAKAb,gBAAA,SAAAN,EAAAK,GACA,WAAAS,QAAA,CAAAC,EAAAC,KACA,IAAAtB,EAAA9B,KAAA+B,QACAD,GACAsB,EAAAC,MAAA,0CAGArD,KAAAmB,aAAAJ,GAEAe,IAAA0B,SAAA1B,IAAA2B,KAAA,KACAN,EAAAf,EAAAsB,oBAEAP,EAAAV,EAAAiB,qBAGAP,EAAAf,EAAAuB,uBAKAX,iBAAA,SAAAJ,GACA,IAAAd,EAAA9B,KAAA+B,QACA,IAAA6B,EAAA9B,EAAAc,GAAAiB,KAAA/B,IAAA,WACA8B,EAAA,IACAA,EAAA9B,EAAAc,GAAAiB,KAAA/B,IAAA,kBAGA8B,GAAA,WAEA5D,KAAAS,UAAAmD,KCxIqVE,EAAA,cCOrVC,EAAgBC,OAAAC,EAAA,KAAAD,CACdF,EACAhE,EACAe,GACF,EACA,KACA,WACA,MAIeqD,EAAA,WAAAH","file":"js/chunk-2d0a3acc.f5b157c6.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"safe-to-drive\"}},[(_vm.isSafe)?_c('div',[_c('p',[_vm._v(\"youâ€™ll be ok for another \"),_c('span',[_vm._v(_vm._s(_vm.waitUntil))])])]):_c('div',[_c('p',[_vm._v(_vm._s(_vm.directionWarning))]),_c('p',[_vm._v(\"or maybe wait about \"+_vm._s(_vm.waitUntil))])]),_c('br'),_c('br'),_c('p',[_c('router-link',{staticClass:\"link\",attrs:{\"to\":\"/about\"}},[_vm._v(\"about\")])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div id='safe-to-drive'>\n\n    <div v-if='isSafe'>\n      <p>you&rsquo;ll be ok for another <span>{{ waitUntil }}</span> </p>\n    </div>\n\n    <div v-else>\n      <p>{{ directionWarning }}</p>\n      <p>or maybe wait about {{ waitUntil }}</p>\n    </div>\n\n    <br /><br />\n    <p><router-link to=\"/about\" class='link'>about</router-link></p>\n  </div>\n</template>\n\n<style scoped>\n</style>\n\n<script>\n\nconst HIGH_DANGER = 12\nconst LOW_DANGER = 3\n\nexport default {\n  name: 'SafeToDrive',\n  props: {\n    sunAltitude: Number,\n    sunAzimuth: Number,\n    userLatitude: Number,\n    userLongitude: Number\n  },\n  data () {\n    return {\n      isSafe: true,\n      waitUntil: ''\n    }\n  },\n  mounted: function () {\n    if (this.sunAltitude >= LOW_DANGER && this.sunAltitude <= HIGH_DANGER) {\n      this.isSafe = false\n    }\n    this.startTimeCalculations()\n  },\n  computed: {\n    directionWarning: function () {\n      if (this.sunAzimuth >= 45 && this.sunAzimuth <= 135) {\n        return 'be careful driving west'\n      }\n      return 'be careful driving east'\n    }\n  },\n  methods: {\n    startTimeCalculations: function () {\n      var moment = this.$moment\n      let now = moment()\n\n      var SunCalc = this.$suncalc\n      SunCalc.addTime(HIGH_DANGER, 'morningDangerEnd', 'eveningDangerBegin')\n      SunCalc.addTime(LOW_DANGER, 'morningDangerBegin', 'eveningDangerEnd')\n      let sunTimesToday = SunCalc.getTimes(now, this.userLatitude, this.userLongitude)\n\n      let vm = this\n\n      if (this.isSafe) {\n        let tomorrow = moment().add(1, 'd')\n        let sunTimesTomorrow = SunCalc.getTimes(tomorrow, this.userLatitude, this.userLongitude)\n        this.getTimeToDanger(sunTimesToday, sunTimesTomorrow)\n          .then(function (timeUntil) {\n            return timeUntil\n          }, function (error) {\n            console.log(error)\n          })\n          .then(function (timeUntil) {\n            vm.writeWaitMessage(timeUntil)\n          })\n      }\n      else {\n        this.getTimeToSafety(sunTimesToday)\n          .then(function (timeUntil) {\n            return timeUntil\n          }, function (error) {\n            console.log(error)\n          })\n          .then(function (timeUntil) {\n            vm.writeWaitMessage(timeUntil)\n          })\n      }\n    },\n\n    getTimeToSafety: function (sunTimesToday) {\n      return new Promise((resolve, reject) => {\n        var moment = this.$moment\n        if (!moment) {\n          reject(Error('getTimeToSafety: cannot access moment'))\n        }\n        // if morning\n        if (this.sunAltitude <= LOW_DANGER) {\n          resolve(sunTimesToday.morningDangerEnd)\n        }\n        else {\n          resolve(sunTimesToday.eveningDangerEnd)\n        }\n      })\n    },\n\n    getTimeToDanger: function (sunTimesToday, sunTimesTomorrow) {\n      return new Promise((resolve, reject) => {\n        var moment = this.$moment\n        if (!moment) {\n          reject(Error('getTimeToDanger: cannot access moment'))\n        }\n        // if night: time to sunrise tomorrow\n        if (this.sunAltitude <= LOW_DANGER) {\n          // after midnight\n          if (moment().isBefore(moment().hour(9))) {\n            resolve(sunTimesToday.morningDangerBegin)\n          }\n          resolve(sunTimesTomorrow.morningDangerBegin)\n        }\n        else {\n          resolve(sunTimesToday.eveningDangerBegin)\n        }\n      })\n    },\n\n    writeWaitMessage: function (timeUntil) {\n      var moment = this.$moment\n      let difference = moment(timeUntil).diff(moment(), 'minutes')\n      if (difference > 119) {\n        difference = moment(timeUntil).diff(moment(), 'hours') + ' hours'\n      }\n      else {\n        difference += ' minutes'\n      }\n      this.waitUntil = difference\n    }\n  }\n}\n\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SafeToDrive.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SafeToDrive.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SafeToDrive.vue?vue&type=template&id=696e9997&scoped=true&\"\nimport script from \"./SafeToDrive.vue?vue&type=script&lang=js&\"\nexport * from \"./SafeToDrive.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"696e9997\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}