{"version":3,"sources":["webpack:///./src/components/SafeToDrive.vue?d736","webpack:///src/components/SafeToDrive.vue","webpack:///./src/components/SafeToDrive.vue?659a","webpack:///./src/components/SafeToDrive.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","_v","_s","waitUntil","directionWarning","staticClass","staticRenderFns","HIGH_DANGER","LOW_DANGER","name","props","sunAltitude","Number","sunAzimuth","userLatitude","userLongitude","isSafe","mounted","startTimeCalculations","computed","methods","moment","$moment","now","SunCalc","$suncalc","addTime","sunTimesToday","getTimes","vm","tomorrow","add","sunTimesTomorrow","getTimeToDanger","getTimeToSafety","Promise","resolve","reject","Error","morningDangerEnd","eveningDangerEnd","isBefore","hour","morningDangerBegin","eveningDangerBegin","writeWaitMessage","timeUntil","difference","diff","component"],"mappings":"yHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,MAAM,CAAC,GAAK,kBAAkB,CAAEN,EAAU,OAAEI,EAAG,MAAM,CAACA,EAAG,IAAI,CAACJ,EAAIO,GAAG,6BAA6BH,EAAG,OAAO,CAACJ,EAAIO,GAAGP,EAAIQ,GAAGR,EAAIS,kBAAkBL,EAAG,MAAM,CAACA,EAAG,IAAI,CAACJ,EAAIO,GAAGP,EAAIQ,GAAGR,EAAIU,qBAAqBN,EAAG,IAAI,CAACJ,EAAIO,GAAG,uBAAuBP,EAAIQ,GAAGR,EAAIS,gBAAgBL,EAAG,MAAMA,EAAG,MAAMA,EAAG,IAAI,CAACA,EAAG,cAAc,CAACO,YAAY,OAAOL,MAAM,CAAC,GAAK,WAAW,CAACN,EAAIO,GAAG,YAAY,MAC3dK,EAAkB,GCqBtB,MAAMC,EAAc,GACdC,EAAa,EAEnB,OACEC,KAAM,cACNC,MAAO,CACLC,YAAaC,OACbC,WAAYD,OACZE,aAAcF,OACdG,cAAeH,QAEjB,OACE,MAAO,CACLI,QAAQ,EACRb,UAAW,KAGfc,QAAS,WACHtB,KAAKgB,aAAeH,GAAcb,KAAKgB,aAAeJ,IACxDZ,KAAKqB,QAAS,GAEhBrB,KAAKuB,yBAEPC,SAAU,CACRf,iBAAkB,WAChB,OAAIT,KAAKkB,YAAc,IAAMlB,KAAKkB,YAAc,IACvC,0BAEF,4BAGXO,QAAS,CACPF,sBAAuB,WACrB,IAAIG,EAAS1B,KAAK2B,QAClB,IAAIC,EAAMF,IAEV,IAAIG,EAAU7B,KAAK8B,SACnBD,EAAQE,QAAQnB,EAAa,mBAAoB,sBACjDiB,EAAQE,QAAQlB,EAAY,qBAAsB,oBAClD,IAAImB,EAAgBH,EAAQI,SAASL,EAAK5B,KAAKmB,aAAcnB,KAAKoB,eAE9Dc,EAAKlC,KAET,GAAIA,KAAKqB,OAAQ,CACf,IAAIc,EAAWT,IAASU,IAAI,EAAG,KAC3BC,EAAmBR,EAAQI,SAASE,EAAUnC,KAAKmB,aAAcnB,KAAKoB,eAC1EpB,KAAKsC,gBAAgBN,EAAeK,GAC5C,kBACU,OAAV,KACA,YACU,QAAV,UAEA,kBACU,EAAV,4BAIQrC,KAAKuC,gBAAgBP,GAC7B,kBACU,OAAV,KACA,YACU,QAAV,UAEA,kBACU,EAAV,wBAKIO,gBAAiB,SAAUP,GACzB,OAAO,IAAIQ,QAAQ,CAACC,EAASC,KAC3B,IAAIhB,EAAS1B,KAAK2B,QACbD,GACHgB,EAAOC,MAAM,0CAGX3C,KAAKgB,aAAeH,EACtB4B,EAAQT,EAAcY,kBAGtBH,EAAQT,EAAca,qBAK5BP,gBAAiB,SAAUN,EAAeK,GACxC,OAAO,IAAIG,QAAQ,CAACC,EAASC,KAC3B,IAAIhB,EAAS1B,KAAK2B,QACbD,GACHgB,EAAOC,MAAM,0CAGX3C,KAAKgB,aAAeH,GAElBa,IAASoB,SAASpB,IAASqB,KAAK,KAClCN,EAAQT,EAAcgB,oBAExBP,EAAQJ,EAAiBW,qBAGzBP,EAAQT,EAAciB,uBAK5BC,iBAAkB,SAAUC,GAC1B,IAAIzB,EAAS1B,KAAK2B,QAClB,IAAIyB,EAAa1B,EAAOyB,GAAWE,KAAK3B,IAAU,WAC9C0B,EAAa,IACfA,EAAa1B,EAAOyB,GAAWE,KAAK3B,IAAU,SAAW,SAGzD0B,GAAc,WAEhBpD,KAAKQ,UAAY4C,KCxI8T,I,YCOjVE,EAAY,eACd,EACAxD,EACAa,GACA,EACA,KACA,WACA,MAIa,aAAA2C,E","file":"js/chunk-2d0a3acc.b57c5f57.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"safe-to-drive\"}},[(_vm.isSafe)?_c('div',[_c('p',[_vm._v(\"youâ€™ll be ok for another \"),_c('span',[_vm._v(_vm._s(_vm.waitUntil))])])]):_c('div',[_c('p',[_vm._v(_vm._s(_vm.directionWarning))]),_c('p',[_vm._v(\"or maybe wait about \"+_vm._s(_vm.waitUntil))])]),_c('br'),_c('br'),_c('p',[_c('router-link',{staticClass:\"link\",attrs:{\"to\":\"/about\"}},[_vm._v(\"about\")])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div id='safe-to-drive'>\n\n    <div v-if='isSafe'>\n      <p>you&rsquo;ll be ok for another <span>{{ waitUntil }}</span> </p>\n    </div>\n\n    <div v-else>\n      <p>{{ directionWarning }}</p>\n      <p>or maybe wait about {{ waitUntil }}</p>\n    </div>\n\n    <br /><br />\n    <p><router-link to=\"/about\" class='link'>about</router-link></p>\n  </div>\n</template>\n\n<style scoped>\n</style>\n\n<script>\n\nconst HIGH_DANGER = 12\nconst LOW_DANGER = 3\n\nexport default {\n  name: 'SafeToDrive',\n  props: {\n    sunAltitude: Number,\n    sunAzimuth: Number,\n    userLatitude: Number,\n    userLongitude: Number\n  },\n  data () {\n    return {\n      isSafe: true,\n      waitUntil: ''\n    }\n  },\n  mounted: function () {\n    if (this.sunAltitude >= LOW_DANGER && this.sunAltitude <= HIGH_DANGER) {\n      this.isSafe = false\n    }\n    this.startTimeCalculations()\n  },\n  computed: {\n    directionWarning: function () {\n      if (this.sunAzimuth >= 45 && this.sunAzimuth <= 135) {\n        return 'be careful driving west'\n      }\n      return 'be careful driving east'\n    }\n  },\n  methods: {\n    startTimeCalculations: function () {\n      var moment = this.$moment\n      let now = moment()\n\n      var SunCalc = this.$suncalc\n      SunCalc.addTime(HIGH_DANGER, 'morningDangerEnd', 'eveningDangerBegin')\n      SunCalc.addTime(LOW_DANGER, 'morningDangerBegin', 'eveningDangerEnd')\n      let sunTimesToday = SunCalc.getTimes(now, this.userLatitude, this.userLongitude)\n\n      let vm = this\n\n      if (this.isSafe) {\n        let tomorrow = moment().add(1, 'd')\n        let sunTimesTomorrow = SunCalc.getTimes(tomorrow, this.userLatitude, this.userLongitude)\n        this.getTimeToDanger(sunTimesToday, sunTimesTomorrow)\n          .then(function (timeUntil) {\n            return timeUntil\n          }, function (error) {\n            console.log(error)\n          })\n          .then(function (timeUntil) {\n            vm.writeWaitMessage(timeUntil)\n          })\n      }\n      else {\n        this.getTimeToSafety(sunTimesToday)\n          .then(function (timeUntil) {\n            return timeUntil\n          }, function (error) {\n            console.log(error)\n          })\n          .then(function (timeUntil) {\n            vm.writeWaitMessage(timeUntil)\n          })\n      }\n    },\n\n    getTimeToSafety: function (sunTimesToday) {\n      return new Promise((resolve, reject) => {\n        var moment = this.$moment\n        if (!moment) {\n          reject(Error('getTimeToSafety: cannot access moment'))\n        }\n        // if morning\n        if (this.sunAltitude <= LOW_DANGER) {\n          resolve(sunTimesToday.morningDangerEnd)\n        }\n        else {\n          resolve(sunTimesToday.eveningDangerEnd)\n        }\n      })\n    },\n\n    getTimeToDanger: function (sunTimesToday, sunTimesTomorrow) {\n      return new Promise((resolve, reject) => {\n        var moment = this.$moment\n        if (!moment) {\n          reject(Error('getTimeToDanger: cannot access moment'))\n        }\n        // if night: time to sunrise tomorrow\n        if (this.sunAltitude <= LOW_DANGER) {\n          // after midnight\n          if (moment().isBefore(moment().hour(9))) {\n            resolve(sunTimesToday.morningDangerBegin)\n          }\n          resolve(sunTimesTomorrow.morningDangerBegin)\n        }\n        else {\n          resolve(sunTimesToday.eveningDangerBegin)\n        }\n      })\n    },\n\n    writeWaitMessage: function (timeUntil) {\n      var moment = this.$moment\n      let difference = moment(timeUntil).diff(moment(), 'minutes')\n      if (difference > 119) {\n        difference = moment(timeUntil).diff(moment(), 'hours') + ' hours'\n      }\n      else {\n        difference += ' minutes'\n      }\n      this.waitUntil = difference\n    }\n  }\n}\n\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SafeToDrive.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SafeToDrive.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SafeToDrive.vue?vue&type=template&id=696e9997&scoped=true&\"\nimport script from \"./SafeToDrive.vue?vue&type=script&lang=js&\"\nexport * from \"./SafeToDrive.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"696e9997\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}